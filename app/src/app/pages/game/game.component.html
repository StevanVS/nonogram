@if (isGameWin) {
  <h1
    class="text-secondary mt-10 mb-4 text-center text-5xl font-black sm:text-6xl"
  >
    {{ board.name | uppercase }}
  </h1>
  <app-img-board
    class="mx-auto block sm:w-150"
    [imgBoard]="{
      tiles: board.coloredTiles,
      width: board.width,
      height: board.height,
    }"
  />
  <div class="mt-8 flex flex-col items-center gap-4">
    <button
      class="hover:bg-tertiary hover:text-primary-dark bg-accent text-primary-dark w-60 cursor-pointer rounded-md px-4 py-2 text-xl font-extrabold"
      (click)="onReset()"
    >
      RESET
    </button>
    <button
      class="bg-primary-light text-secondary hover:bg-tertiary hover:text-primary-dark w-60 cursor-pointer rounded-md px-4 py-2 text-xl font-extrabold"
      routerLink="/levels"
    >
      EXIT
    </button>
  </div>
} @else {
  <div class="mt-10 mb-4 flex items-center justify-center gap-2">
    <div class="bg-tertiary size-6 rounded-md"></div>
    <div class="text-xl font-bold">
      {{ gameFilledTilesCounter() }} / {{ board.filledTilesCount }}
    </div>
  </div>
  <div
    class="mx-auto grid aspect-square grid-cols-[25%_auto] grid-rows-[25%_auto] gap-1 leading-none font-bold sm:w-150"
  >
    <div class="flex h-full items-center justify-center">
      <button
        class="size-1/2 p-2"
        [ngClass]="{
          'fill-secondary hover:fill-tertiary cursor-pointer':
            this.game.history.length > 0,
          'fill-primary': this.game.history.length === 0,
        }"
        (click)="onHistoryBack()"
        [disabled]="this.game.history.length === 0"
      >
        <svg
          class="rotate-45"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 640 640"
        >
          <path
            d="M320 128C263.2 128 212.1 152.7 176.9 192L224 192C241.7 192 256 206.3 256 224C256 241.7 241.7 256 224 256L96 256C78.3 256 64 241.7 64 224L64 96C64 78.3 78.3 64 96 64C113.7 64 128 78.3 128 96L128 150.7C174.9 97.6 243.5 64 320 64C461.4 64 576 178.6 576 320C576 461.4 461.4 576 320 576C233 576 156.1 532.6 109.9 466.3C99.8 451.8 103.3 431.9 117.8 421.7C132.3 411.5 152.2 415.1 162.4 429.6C197.2 479.4 254.8 511.9 320 511.9C426 511.9 512 425.9 512 319.9C512 213.9 426 128 320 128z"
          />
        </svg>
      </button>
    </div>

    <div class="col-start-2 flex">
      @for (groupNumber of gameColumnNumbers(); track $index) {
        <div
          [ngClass]="{
            'bg-primary text-primary-dark': groupNumber.complete,
            'bg-primary-light': !groupNumber.complete,
          }"
          class="mx-0.5 flex flex-1 flex-col items-center justify-end gap-1.5 rounded-sm pb-1"
        >
          @for (number of groupNumber.gameTilesNumbers; track $index) {
            <div [ngClass]="{ 'text-primary-dark': number.complete }">
              {{ number.number }}
            </div>
          }
        </div>
      }
    </div>
    <div class="flex flex-col">
      @for (groupNumber of gameRowNumbers(); track $index) {
        <div
          [ngClass]="{
            'bg-primary text-primary-dark': groupNumber.complete,
            'bg-primary-light': !groupNumber.complete,
          }"
          class="my-0.5 flex flex-1 flex-row items-center justify-end gap-1.5 rounded-sm pr-2"
        >
          @for (number of groupNumber.gameTilesNumbers; track $index) {
            <div [ngClass]="{ 'text-primary-dark': number.complete }">
              {{ number.number }}
            </div>
          }
        </div>
      }
    </div>
    <div
      class="bg-secondary-dark grid touch-none overflow-hidden rounded-sm"
      [style]="{
        gridTemplateColumns: 'repeat(' + board.width + ', 1fr)',
        gridTemplateRows: 'repeat(' + board.height + ', 1fr)',
      }"
      (contextmenu)="onContextMenu($event)"
      (pointerdown)="onMouseDown($event)"
      (pointermove)="onMouseMove($event)"
      (pointerleave)="onMouseUp($event)"
      (pointerup)="onMouseUp($event)"
    >
      @for (tile of gameTiles(); track $index) {
        <div
          [attr.data-index]="$index"
          class="tile border-primary-light"
          [ngClass]="{
            'bg-tertiary': tile === 1,
            'border-t': $index / board.width >= 1,
            'border-r': $index % board.width < board.width - 1,
            'border-b': $index / board.width < board.height - 1,
            'border-l': $index % board.width >= 1,
          }"
        >
          @if (tile === -1) {
            <div
              class="pointer-events-none flex h-full items-center justify-center"
            >
              <svg
                class="fill-tertiary stroke-tertiary size-3/4 stroke-20"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 640 640"
              >
                <path
                  d="M183.1 137.4C170.6 124.9 150.3 124.9 137.8 137.4C125.3 149.9 125.3 170.2 137.8 182.7L275.2 320L137.9 457.4C125.4 469.9 125.4 490.2 137.9 502.7C150.4 515.2 170.7 515.2 183.2 502.7L320.5 365.3L457.9 502.6C470.4 515.1 490.7 515.1 503.2 502.6C515.7 490.1 515.7 469.8 503.2 457.3L365.8 320L503.1 182.6C515.6 170.1 515.6 149.8 503.1 137.3C490.6 124.8 470.3 124.8 457.8 137.3L320.5 274.7L183.1 137.4z"
                />
              </svg>
            </div>
          }
        </div>
      }
    </div>
  </div>

  <label class="mx-auto mt-8 block w-fit cursor-pointer">
    <input
      type="checkbox"
      [checked]="isCursorBlock"
      (change)="onChangeCursor()"
      class="sr-only"
    />
    <div
      class="bg-primary relative flex h-15 w-30 items-center justify-around rounded-s-full rounded-e-full"
    >
      <div
        class="bg-secondary-light border-primary absolute z-10 aspect-square h-full rounded-full border-4"
        [ngClass]="isCursorBlock ? 'right-0' : 'left-0'"
      ></div>
      <svg
        class="fill-primary-dark stroke-primary-dark z-20 h-1/2 stroke-20"
        [ngClass]="{ 'fill-tertiary stroke-tertiary': !isCursorBlock }"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 640 640"
      >
        <path
          d="M183.1 137.4C170.6 124.9 150.3 124.9 137.8 137.4C125.3 149.9 125.3 170.2 137.8 182.7L275.2 320L137.9 457.4C125.4 469.9 125.4 490.2 137.9 502.7C150.4 515.2 170.7 515.2 183.2 502.7L320.5 365.3L457.9 502.6C470.4 515.1 490.7 515.1 503.2 502.6C515.7 490.1 515.7 469.8 503.2 457.3L365.8 320L503.1 182.6C515.6 170.1 515.6 149.8 503.1 137.3C490.6 124.8 470.3 124.8 457.8 137.3L320.5 274.7L183.1 137.4z"
        />
      </svg>
      <div
        class="bg-primary-dark z-20 aspect-square h-1/2 rounded-sm"
        [ngClass]="{ 'bg-tertiary': isCursorBlock }"
      ></div>
    </div>
  </label>
}
